"use strict";var timer=null,checkoutRequestID=null,reqCounter=0,paymentDialog=!1,error=null,validatingPayment=!1,phone=null,amount=null;function stkPushQuery(e){error=null,timer=setInterval(function(){if(10===(reqCounter+=1))return clearInterval(timer),void $("#stkErrorMessage").text("You took too long to pay!");$.post("http://localhost/sparklesdigital/assets/mpesa/stkquery.php",{ref:e},function(e,t){if(e=JSON.parse(e),"success"!==t)return clearInterval(timer),void $("#stkErrorMessage").text("Internal error occured. PLease try again later!");if("0"===e.ResultCode)clearInterval(timer),$("#stkMessage").show(),$("#depositBtn").text("Request Processed Successfully");else{if("500.001.1001"!==e.errorCode)return clearInterval(timer),$("#stkErrorMessage").text(e.ResultDesc),void $("#stkErrorMessage").show();$("#stkErrorMessage").text(e.errorMessage),$("#stkErrorMessage").show()}})},5e3)}$(document).ready(function(e){$("#depositBtn").on("click",function(e){e.preventDefault(),$("#depositBtn").text("Sending Request..."),$("#stkErrorMessage").hide(),phone=$("#phone").val(),amount=$("#amount").val(),$("#depositBtn").attr("disabled","disabled"),$.post("http://localhost/sparklesdigital/assets/mpesa/stkpush.php",{phone:phone,amount:amount},function(e,t){"success"===t&&($("#senderPhone").text(phone),stkPushQuery(checkoutRequestID=e))})})}),$(document).ready(function(e){$("#accountBtn").on("click",function(e){e.preventDefault(),$("#accountBtn").text("Sending Request..."),$("#stkErrorMessage").hide(),phone=$("#phone").val(),amount=1,$("#accountBtn").attr("disabled","disabled"),$.post("http://localhost/sparklesdigital/assets/mpesa/stkpush.php",{phone:phone,amount:amount},function(e,t){"success"===t&&($("#senderPhone").text(phone),stkPushQuery(checkoutRequestID=e))})})});
